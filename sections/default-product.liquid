{%- comment -%} Default Product wrapper for OS2.0. Mirrors product.liquid on vintage theme. {%- endcomment -%}

<style>
  .product-reviews .yotpo-main-widget { padding-top: 0; }
</style>

{%- comment -%} Product core (your old product-router snippet) {%- endcomment -%}
{% render 'product-router' %}

{%- comment -%} PDP FAQ (your old snippet) {%- endcomment -%}
{% render 'pdp-faq-router' %}

{%- comment -%} Back to collection link (unchanged) {%- endcomment -%}
{% if collection %}
  <div class="text-center return-link-wrapper page-width">
    <a href="{{ collection.url }}" class="btn btn--secondary btn--has-icon-before return-link">
      {% render 'icon-arrow-left' %}
      {{ 'products.product.back_to_collection' | t: title: collection.title }}
    </a>
  </div>
{% endif %}

{%- comment -%} Yotpo reviews block (unchanged) {%- endcomment -%}
<div class="flex flex-col w-full md:w-9/12 my-0 mx-auto min-h-[58px]">
  <div class="yotpo-widget-instance"
       data-yotpo-instance-id="436651"
       data-yotpo-product-id="{{ product.id }}"
       data-yotpo-name="{{ product.title | escape }}"
       data-yotpo-url="{{ shop.url }}{{ product.url }}"
       data-yotpo-image-url="{{ product.featured_image | product_img_url: 'large' | prepend: 'https:' | replace: '?', '%3F' | replace: '&amp;','%26' }}"
       data-yotpo-price="{{ product.price | divided_by: 100.00 }}"
       data-yotpo-currency="{{ shop.currency }}"
       data-yotpo-description="{{ product.description | escape }}"></div>
</div>

<script>
  // Keep the same strings the theme expects
  window.theme = window.theme || {};
  theme.productStrings = {
    addToCart: {{ 'products.product.add_to_cart' | t | json }},
    soldOut: {{ 'products.product.sold_out' | t | json }},
    unavailable: {{ 'products.product.unavailable' | t | json }}
  };
</script>

{%- assign current_variant = product.selected_or_first_available_variant -%}
<script type="application/ld+json">
{
  "@context":"http://schema.org/",
  "@type":"Product",
  "name": {{ product.title | json }},
  "url": {{ shop.url | append: product.url | json }},
  {% if product.featured_media %}
    {% assign media_size = product.featured_media.preview_image.width | append: 'x' %}
    "image": [ {{ product.featured_media | img_url: media_size | prepend: "https:" | json }} ],
  {% endif %}
  "description": {{ product.description | strip_html | json }},
  {% if current_variant.sku != blank %}
    "sku": {{ current_variant.sku | json }},
  {% endif %}
  {% if product.metafields.yotpo.reviews_count and product.metafields.yotpo.reviews_count != '0' %}
    "aggregateRating": {
      "@type":"AggregateRating",
      "ratingValue":"{{ product.metafields.yotpo.reviews_average }}",
      "ratingCount":"{{ product.metafields.yotpo.reviews_count }}",
      "reviewCount":"{{ product.metafields.yotpo.reviews_count }}"
    },
  {% endif %}
  "brand": { "@type":"Thing", "name": {{ product.vendor | json }} },
  "offers": [
    {% for variant in product.variants %}
      {
        "@type":"Offer",
        {% if variant.sku != blank %}"sku": {{ variant.sku | json }},{% endif %}
        "availability":"http://schema.org/{% if variant.available %}InStock{% else %}OutOfStock{% endif %}",
        "price": {{ variant.price | divided_by: 100.00 | json }},
        "priceCurrency": {{ cart.currency.iso_code | json }},
        "url": {{ shop.url | append: variant.url | json }}
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

<!-- Conversion Pixel (unchanged) -->
<img src="https://data.adxcel-ec2.com/pixel/?ad_log=referer&action=signup&pixid=1106a134-d88c-4d2e-a6cd-468261774399" width="1" height="1" alt="">

{% schema %}
{
  "name": "Default product (legacy)",
  "settings": []
}
{% endschema %}
