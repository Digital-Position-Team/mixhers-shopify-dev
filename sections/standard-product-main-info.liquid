{% assign product_title = product.metafields.rebrand.product_title.value | default: product.title %}
{% assign product_subtitle = product.metafields.rebrand.product_subtitle.value | default: '' %}
{% assign product_caption = product.metafields.rebrand.product_caption.value | default: '' %}
{% assign product_description = product.metafields.rebrand.product_description | metafield_tag | default: product.description %}
{% assign promo_content = product.metafields.rebrand.promo_content.value %}
{% assign promo_badge = promo_content.promo_badge | default: '' %}
{% assign show_promo_badge_above_title = promo_content.show_promo_badge | default: false %}
{% assign supplement_facts_title = product.metafields.rebrand.supplement_facts_title.value | default: null %}
{% assign supplement_facts_image = product.metafields.rebrand.supplement_facts_image.value | default: null %}
{% assign top_faqs = product.metafields.rebrand.top_faqs.value %}
<div class="product-info-main">
  <div class="standard-product-image">
    {% render 'standard-product-image-slider' %}
  </div>

  <div class="standard-product-info">
    {% for block in section.blocks %}
      {% case block.type %}

        {% when "promo_badge" %}
          {% if show_promo_badge_above_title %}
            <p class="promo_badge">{{ promo_badge}}</p>
          {% endif %}

        {% when "product_title" %}
          <h1 class="font-serif standard-product-title"> {{ product_title }}</h1>

        {% when "product_subtitle" %}
          <p class="standard-product-subtitle">{{product_subtitle}}</p>

        {% when "product_caption" %}
          <p class="standard-product-caption">{{ product_caption}}</p>

        {% when "product_rating" %}
          <div class="standard-product-rating">
              <div
                  class="yotpo-widget-instance pink-stars "
                  data-yotpo-instance-id="585542"
                  data-yotpo-product-id="{{product.id}}"
                  data-yotpo-cart-product-id="{{product.id}}"
                  data-yotpo-section-id="{{template.name}}"
              ></div>
          </div>
    
        {% when "supplement_facts_button" %}
          {% if supplement_facts_title %}
            <button type="button" class="open-btn" onclick="openSupplementFactsModal()" {% unless supplement_facts_image %}disabled{% endunless %}>
              {{ supplement_facts_title }}
            </button>
          {% endif %}

        {% when "product_description" %}
          <div class="standard-product-description font-sans base-text">
            {{ product_description}}
          </div>

        {% when "shared_details" %}
          {% render 'shared-product-details', then_render: 'add-to-cart-with-options', product_id:product.iid %}

        {% when "faq_block" %}
          {% assign faqs = product.metafields.rebrand.top_faqs.value %}
          {% if faqs %}
            <div class="product-faq-div">
              {% for faq in faqs %}
                <details class="product-faq">
                  <summary>
                    <div class="faq-title">
                      <p>{{ faq.title }}</p>
                      <span>
                        <svg class="icon-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 5v14m-7-7h14"/></svg>
                        <svg class="icon-minus" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M5 12h14"/></svg>
                      </span>
                    </div>
                  </summary>
                  {% assign content = faq.contents | metafield_tag %}
                  <div class="faq-detail">{{ content }}</div>
                </details>
              {% endfor %}
            </div>
          {% endif %}

        {% when "disclaimer" %}
          <p class="disclaimer-text">
            {{ block.settings.text }}
          </p>

      {% endcase %}
    {% endfor %}
  </div>
</div>

<!-- Supplement Facts Modal -->
<div id="supplementFactsModal" class="" onclick="closeSupplementFactsModal()">
  <div id="supplementFacts" class="supplements-inner-body">
    <button class="modal-close-x" onclick="closeSupplementFactsModal()" type="button">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
    <img src="{{ product.metafields.rebrand.supplement_facts_image.value | image_url }}" alt="Supplement Facts" class="object-contain" width="auto" height="auto" />
  </div>
</div>

{% schema %}
{
  "name": "Standard Product Info ",
  "settings": [],
  "blocks": [
    {
      "type": "promo_badge",
      "name": "Promo Badge",
      "settings": []
    },
    {
      "type": "product_title",
      "name": "Product Title",
      "settings": []
    },
    {
      "type": "product_subtitle",
      "name": "Product Subtitle",
      "settings": []
    },
    {
      "type": "product_caption",
      "name": "Product Caption",
      "settings": []
    },
    {
      "type": "product_rating",
      "name": "product_rating",
      "settings": []
    },
    {
      "type": "supplement_facts_button",
      "name": "Supplement Facts Button",
      "settings": []
    },
    {
      "type": "product_description",
      "name": "Product Description",
      "settings": []
    },
    {
      "type": "shared_details",
      "name": "Shared Product Details",
      "settings": []
    },
    {
      "type": "faq_block",
      "name": "FAQs",
      "settings": []
    },
    {
      "type": "disclaimer",
      "name": "Disclaimer",
      "settings": [
        {
          "type": "textarea",
          "id": "text",
          "label": "Disclaimer Text",
          "default": "* These statements have not been evaluated by the Food and Drug Administration. This product is not intended to diagnose, treat, cure, or prevent any disease."
        }
      ]
    }
  ],
"presets": [
  {
    "name": "Product Info Default",
    "blocks": [
      {
        "type": "promo_badge",
        "settings": {}
      },
      {
        "type": "product_title",
        "settings": {}
      },
      {
        "type": "product_subtitle",
        "settings": {}
      },
      {
        "type": "product_caption",
        "settings": {}
      },
       {
        "type": "product_rating",
        "settings": {}
      },
      {
        "type": "supplement_facts_button",
        "settings": {}
      },
      {
        "type": "product_description",
        "settings": {}
      },
      {
        "type": "shared_details",
        "settings": {}
      },
      {
        "type": "faq_block",
        "settings": {}
      },
      {
        "type": "disclaimer",
        "settings": {
          "text": "* These statements have not been evaluated by the Food and Drug Administration. This product is not intended to diagnose, treat, cure, or prevent any disease."
        }
      }
    ]
  }
]
}
{% endschema %}

<style>
  .modal-close-x {
    position: absolute;
    top: -22px;
    right: -20px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
    z-index: 1000;
  }
  
  .modal-close-x:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }
  
  .modal-close-x svg {
    width: 24px;
    height: 24px;
  }
  
  #supplementFacts {
    position: relative;
  }
</style>

<script>
      function openSupplementFactsModal() {
        document.getElementById('supplementFactsModal').style.display = 'flex';
    }

    function closeSupplementFactsModal() {
        document.getElementById('supplementFactsModal').style.display = 'none';
    }

</script>