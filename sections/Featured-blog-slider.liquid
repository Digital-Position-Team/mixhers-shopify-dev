<div class="featured-articles">
  <h2 class="section-title">{{ section.settings.title }}</h2>

  <div class="articles-scroll-container">
    <div class="articles-scroll">
      {% liquid
        assign articleIndex = 0 
        for article in section.settings.selected_blog.articles 
          if article.metafields.custom.featured_article and articleIndex < section.settings.limit 
            render 'featured-article-card', article: article, featuredCard: true
            assign articleIndex = articleIndex | plus: 1 
          endif
        endfor
      %}
    </div>
  </div>

  <div class="articles-scroll-controls">
    <button class="scroll-btn" data-direction="left">
     left arrow
    </button>
    <button class="scroll-btn" data-direction="right">
      right arrow
    </button>
  </div>
</div>

<script>
  document.querySelectorAll('.scroll-btn').forEach(button => {
    button.addEventListener('click', () => {
      const carousel = document.querySelector('.articles-scroll');
      const direction = button.dataset.direction;
      const card = carousel.querySelector('.article-card--featured');
      const scrollAmount = card.offsetWidth + 25;
      const currentScroll = carousel.scrollLeft;
      const maxScroll = carousel.scrollWidth - carousel.offsetWidth;

      if (direction === 'left') {
        carousel.scrollTo({ left: currentScroll === 0 ? maxScroll : currentScroll - scrollAmount, behavior: 'smooth' });
      } else {
        carousel.scrollTo({ left: currentScroll >= maxScroll ? 0 : currentScroll + scrollAmount, behavior: 'smooth' });
      }
    });
  });
</script>

{% schema %}
{
  "name": "Featured Articles",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Featured Articles"
    },
    {
      "type": "range",
      "id": "limit",
      "label": "Number of articles",
      "min": 1,
      "max": 10,
      "step": 1,
      "default": 5
    },
    {
      "type": "blog",
      "id": "selected_blog",
      "label": "Select Blog"
    }
  ],
  "presets": [
    {
      "name": "Featured Articles",
      "category": "Blog"
    }
  ]
}
{% endschema %}
