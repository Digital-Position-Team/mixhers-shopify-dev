{% schema %}
{
  "name": "Collection Tabs Filter",
  "settings": [],
  "presets": [
    {
      "name": "Collection Tabs Filter"
    }
  ]
}
{% endschema %}
<style>
    .active-tag {
        background-color: #ff59e4;
        color: #fff;
    }
    .active-tag:hover {
        color: #fff;
    }
</style>

<div class="overflow-scroll flex gap-1 px-3 py-3 whitespace-nowrap md:px-6" style="scrollbar-color: white white;">
    <button
        id="all-products-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full active-tag"
        onclick="handleFilter('all-products')"
    >
        {% render 'text', type: 'body-md', content: 'All' %}
    </button>
    <button
        id="holiday-shopping-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('holiday-shopping')"
    >
        {% render 'text', type: 'body-md', content: '⭐️ Holiday Shopping' %}
    </button>
    <button
        id="pms-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('pms')"
    >
        {% render 'text', type: 'body-md', content: 'PMS' %}
    </button>
    <button
        id="motherhood-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('motherhood')"
    >
        {% render 'text', type: 'body-md', content: 'Motherhood' %}
    </button>
    <button
        id="menopause-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('menopause')"
    >
        {% render 'text', type: 'body-md', content: 'Menopause' %}
    </button>
    <button
        id="health-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('health')"
    >
        {% render 'text', type: 'body-md', content: 'Health & Nutrition' %}
    </button>
    <button
        id="sexual-wellness-tag"
        class="filter-tag text-black hover:text-pink px-4 py-2 rounded-full"
        onclick="handleFilter('sexual-wellness')"
    >
        {% render 'text', type: 'body-md', content: 'Sexual Wellness' %}
    </button>
    <a
        id="sale-tag"
        class="text-pink hover:border hover:border-pink focus:border focus:border-pink px-3 py-1 flex items-center"
        href="/collections/final-sale"
    >
        {% render 'text', type: 'body-md', content: 'Sale'%}
    </a>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        checkInitialQueryParams();
    });

    function checkInitialQueryParams() {
        const urlParams = new URLSearchParams(window.location.search);
        const collection = urlParams.get('collection');
        if (collection) {
            const validFilters = ['all-products', 'holiday-shopping', 'pms', 'motherhood', 'menopause', 'health', 'sexual-wellness'];
            if (validFilters.includes(collection)) {
                handleFilter(collection);
            } else {
                handleFilter('all-products'); // Default to 'all-products' if no valid collection is found
            }
        } else {
            handleFilter('all-products'); // Default to 'all-products' if no collection param is present
        }
    }

    function handleFilter(filter) {
        let urlParams = new URLSearchParams(window.location.search);
        urlParams.set('collection', filter);
        let newPath =
            window.location.protocol +
            '//' +
            window.location.host +
            window.location.pathname +
            '?' +
            urlParams.toString();
        window.history.pushState({ path: newPath }, '', newPath);

        const allFilterTagEls = document.querySelectorAll('.filter-tag');
        const filterTagEl = document.getElementById(`${filter}-tag`);

        allFilterTagEls.forEach((el) => {
            el.classList.remove('active-tag');
        });

        filterTagEl?.classList.add('active-tag');
        const allFilterResultsEls = document.querySelectorAll('.filter-results');
        const filterResultsEl = document.getElementById(`${filter}-results`);

        allFilterResultsEls.forEach((el) => {
            el.classList.add('hidden');
        });

        if (filter === 'holiday-shopping') {
            const giftingFilterResultsEl = document.getElementById('holiday-shopping-results');
            giftingFilterResultsEl.classList.remove('hidden');
            giftingFilterResultsEl.classList.add('grid');
        } else {
            if (filter === 'final-sale') {
                const finalSaleFilterResultsEl = document.getElementById('final-sale-results');
                finalSaleFilterResultsEl.classList.remove('hidden');
                finalSaleFilterResultsEl.classList.add('visible');
            } else {
                filterResultsEl?.classList.remove('hidden');
                filterResultsEl?.classList.add('grid');
            }
        }
    }
</script>

